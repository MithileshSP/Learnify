# SRM Campus Portal Backend

This Go service powers the SRM campus experience. It exposes a REST API, authenticates users with JWTs, and persists data in MongoDB.

## Prerequisites

- Go 1.22+
- MongoDB Atlas (or compatible MongoDB deployment)
- Environment variables defined in `.env` (see `.env.example` if present)

## Running locally

```powershell
cd backend
air
```

The server listens on `http://localhost:8080`. API routes are namespaced under `/api`.

## Research feed endpoints

Research posts are stored in the `research_posts` collection. Sample posts are seeded automatically on startup. Authenticated users can query and create posts using the following endpoints:

| Method | Endpoint             | Description                              |
| ------ | -------------------- | ---------------------------------------- |
| GET    | `/api/research/posts` | Fetch research feed items for the viewer |
| POST   | `/api/research/posts` | Publish a new research update            |

### GET `/api/research/posts`

Optional query parameters:

- `limit` – maximum number of posts to return (default: all)

Response body:

```json
{
  "items": [
    {
      "id": "6652e5b1d94f41e6b4d3fa91",
      "title": "Breakthrough in AI-driven sustainable agriculture",
      "summary": "Our team published a paper on using neural networks...",
      "category": "Collaboration",
      "tags": ["AI", "Sustainability", "AgriTech"],
      "author": {
        "name": "Dr. Evelyn Reed",
        "role": "Lead Researcher · AI Sustainability Lab"
      },
      "timestamp": "2 hours ago",
      "createdAt": "2025-10-03T07:20:11Z",
      "stats": {
        "likes": 25,
        "comments": 18,
        "collaborations": 3
      },
      "isCollaboration": true,
      "isMine": false,
      "trending": true
    }
  ]
}
```

### POST `/api/research/posts`

Expected JSON payload:

```json
{
  "title": "Need insight on quantum coherence times",
  "summary": "We're optimizing qubit coherence times under noisy conditions...",
  "body": "We're optimizing qubit coherence times under noisy conditions...",
  "tags": ["Quantum", "Research"],
  "category": "Collaboration",
  "link": "https://research.example.com/quantum",
  "image": "https://cdn.example.com/covers/quantum.jpg",
  "isCollaboration": true
}
```

All fields are optional except for the main content (`summary` or `body`). The service normalizes tags, derives a title if missing, and defaults to `My Research` unless `isCollaboration` is set.

Responses include the stored post object. New posts start with zero likes/comments/collaborations and appear immediately in the student dashboard feed.

## Authentication

Authenticated requests require a `Bearer` token issued by the `/api/auth/login` endpoint. Protected routes, including the research feed APIs, enforce JWT validation via the shared middleware.

## Development tips

- Update `insertSampleData` in `main.go` to tweak seed users, quests, or research posts.
- Use `go build ./...` to ensure the server compiles after changes.
- Run `npm run build` from the `frontend` folder to verify the UI continues to compile after API changes.
